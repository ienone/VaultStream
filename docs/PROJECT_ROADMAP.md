# VaultStream 项目总结与未来规划

## 1. 项目概览

VaultStream 是一个私有化内容归档与分发系统，旨在帮助用户保存来自多个社交平台的高价值内容，提供统一的浏览体验，并支持推送到其他渠道（如 Telegram）。

### 架构
- **前端**: Flutter (Mobile/Desktop/Web)，基于 Riverpod 状态管理，Material 3 设计风格。
- **后端**: Python (FastAPI)，异步架构。
- **数据库**: SQLite (轻量级，支持 FTS5 全文搜索)。
- **存储**: 本地文件系统 (LocalStorage)，支持图片转码 (WebP) 和视频下载。
- **任务队列**: 基于 SQLite 的持久化队列，支持重试与死信处理。

## 2. 现有功能

### 2.1 支持平台
| 平台 | 解析能力 | 媒体处理 | 备注 |
| :--- | :--- | :--- | :--- |
| **Bilibili** | 视频、专栏、动态 (Opus) | 图片转码 | 动态支持完整图文归档 |
| **Twitter/X** | 推文 (FxTwitter) | 图片/视频代理 | 支持多图、视频播放 |
| **微博** | 博文 (Status) | 图片转码、视频下载 | **新增**：支持长文、多图、视频、链接解析 |
| **小红书** | 笔记 | 图片下载 | |
| **知乎** | 回答/文章 | 图片下载 | |

### 2.2 前端功能 (Collection)
- **瀑布流/网格视图**: 自适应布局，支持卡片悬浮效果。
- **详情页**:
    - **多媒体浏览**: 支持图片轮播 (PageView) 和全屏缩放 (InteractiveViewer)。
    - **视频播放**: **新增** 内置视频播放器 (Chewie)，支持微博/Twitter 视频播放。
    - **富文本渲染**: 解析 Markdown 格式的归档内容 (B站/微博长文)。
    - **自适应布局**: 宽屏模式下采用左右分栏 (类似 Twitter Web)，左侧媒体右侧信息。
- **交互**: 支持复制链接、跳转原文、编辑标签、删除内容。

## 3. 未来开发改进方向

### 3.1 前端 (Beyond Collection)
目前前端主要聚焦于内容收集与详情展示，未来可扩展：

*   **仪表盘 (Dashboard) 增强**:
    *   可视化统计：各平台归档数量趋势、标签分布饼图。
    *   存储管理：查看存储占用，清理无用缓存/媒体。
    *   任务监控：实时查看后台解析队列状态，手动重试失败任务。
*   **审核/分发流 (Review & Distribute)**:
    *   专门的审核界面 (Tinder-like swiping?)，快速决定是否分发到 Telegram。
    *   分发规则配置界面：前端可视化配置自动分发规则。
*   **设置页面 (Settings)**:
    *   API Token 配置、Cookie 管理 (无需手动改 .env)。
    *   外观设置：主题色、字体大小、夜间模式切换。
*   **搜索体验**:
    *   高级搜索界面：支持按时间、作者、类型组合筛选。
    *   FTS5 搜索结果高亮显示。

### 3.2 平台扩展
*   **YouTube**: 支持下载视频/音频 (yt-dlp 集成)，归档元数据。
*   **Instagram**: 解析 Post/Reel，下载图片/视频。
*   **Telegram**: 反向归档 (从 Telegram 保存到 VaultStream)。
*   **通用网页**: 基于 Readability 提取通用文章内容。

### 3.3 系统优化
*   **插件化适配器**: 将适配器解耦，支持热加载/脚本化扩展。
*   **多用户支持**: 虽然是私有部署，但可支持家庭/团队共享。
*   **移动端适配优化**: 针对 iOS/Android 的分享意图 (Share Intent) 深度集成，实现“一键保存”。

## 4. 总结
VaultStream 已具备核心的“采集-解析-归档-展示”闭环能力。近期的改进显著提升了微博和 Twitter 内容的浏览体验，使得多媒体内容在本地也能流畅回溯。接下来的重点将从“能用”转向“好用”，完善管理功能并扩展更多数据源。
