<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VaultStream</title>
    
    <style>
        :root {
            --md-sys-color-primary: #6750A4;
            --md-sys-color-on-primary: #FFFFFF;
            --md-sys-color-primary-container: #EADDFF;
            --md-sys-color-on-primary-container: #21005D;
            --md-sys-color-secondary: #625B71;
            --md-sys-color-on-secondary: #FFFFFF;
            --md-sys-color-surface: #FEF7FF;
            --md-sys-color-on-surface: #1D1B20;
            --md-sys-color-surface-variant: #E7E0EC;
            --md-sys-color-on-surface-variant: #49454F;
            --md-sys-color-outline: #79747E;
            --md-sys-color-outline-variant: #CAC4D0;
            --md-sys-color-error: #B3261E;
            --md-sys-color-success: #2E7D32;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', system-ui, -apple-system, sans-serif;
            background-color: var(--md-sys-color-surface);
            color: var(--md-sys-color-on-surface);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 24px;
            /* background-image: 
                radial-gradient(at 0% 0%, hsla(253,16%,7%,1) 0, transparent 50%), 
                radial-gradient(at 50% 0%, hsla(225,39%,30%,1) 0, transparent 50%), 
                radial-gradient(at 100% 0%, hsla(339,49%,30%,1) 0, transparent 50%); */
            background-attachment: fixed;
        }

        .container {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 32px;
            padding: 40px;
            max-width: 560px;
            width: 100%;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
        }

        h1 {
            font-family: 'Google Sans', sans-serif;
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--md-sys-color-primary);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .subtitle {
            font-size: 16px;
            color: var(--md-sys-color-on-surface-variant);
            margin-bottom: 32px;
        }

        .form-group {
            margin-bottom: 24px;
            position: relative;
        }

        .field-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 8px;
            margin-left: 4px;
            color: var(--md-sys-color-on-surface-variant);
        }

        input[type="text"],
        input[type="url"] {
            width: 100%;
            padding: 16px 20px;
            background: var(--md-sys-color-surface-variant);
            border: 2px solid transparent;
            border-radius: 16px;
            font-size: 16px;
            color: var(--md-sys-color-on-surface);
            transition: all 0.2s ease;
        }

        input:focus {
            outline: none;
            border-color: var(--md-sys-color-primary);
            background: white;
            box-shadow: 0 0 0 4px var(--md-sys-color-primary-container);
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 4px;
            cursor: pointer;
            user-select: none;
        }

        input[type="checkbox"] {
            width: 20px;
            height: 20px;
            accent-color: var(--md-sys-color-primary);
            cursor: pointer;
        }

        button {
            width: 100%;
            padding: 18px;
            background: var(--md-sys-color-primary);
            color: var(--md-sys-color-on-primary);
            border: none;
            border-radius: 20px;
            font-family: 'Google Sans', sans-serif;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            margin-top: 8px;
        }

        button:hover {
            background: #5a4390;
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(103, 80, 164, 0.3);
        }

        button:active {
            transform: scale(0.98);
        }

        button:disabled {
            background: var(--md-sys-color-outline);
            cursor: not-allowed;
            transform: none;
        }

        svg {
            width: 24px;
            height: 24px;
            flex-shrink: 0;
        }

        .result {
            margin-top: 24px;
            padding: 20px;
            border-radius: 24px;
            display: none;
            animation: slideUp 0.4s ease-out;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result.success {
            background: #E8F5E9;
            color: var(--md-sys-color-success);
            border: 1px solid #C8E6C9;
        }

        .result.error {
            background: #FFEBEE;
            color: var(--md-sys-color-error);
            border: 1px solid #FFCDD2;
        }

        .examples {
            margin-top: 40px;
            padding-top: 24px;
            border-top: 1px solid var(--md-sys-color-outline-variant);
        }

        .examples h3 {
            font-family: 'Google Sans', sans-serif;
            font-size: 14px;
            font-weight: 500;
            color: var(--md-sys-color-on-surface-variant);
            margin-bottom: 16px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .example-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .chip {
            padding: 8px 16px;
            background: white;
            border: 1px solid var(--md-sys-color-outline-variant);
            border-radius: 12px;
            font-size: 14px;
            color: var(--md-sys-color-on-surface);
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .chip:hover {
            background: var(--md-sys-color-primary-container);
            border-color: var(--md-sys-color-primary);
            color: var(--md-sys-color-on-primary-container);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M720-80q-50 0-85-35t-35-85q0-7 1-14.5t3-13.5L322-392q-17 15-38 23.5t-44 8.5q-50 0-85-35t-35-85q0-50 35-85t85-35q23 0 44 8.5t38 23.5l282-164q-2-6-3-13.5t-1-14.5q0-50 35-85t85-35q50 0 85 35t35 85q0 50-35 85t-85 35q-23 0-44-8.5t-38-23.5L352-480q2 6 3 13.5t1 14.5q0 7-1 14.5t-3 13.5l282 164q17-15 38-23.5t44-8.5q50 0 85 35t35 85q0 50-35 85t-85 35Zm0-640q17 0 28.5-11.5T760-760q0-17-11.5-28.5T720-800q-17 0-28.5 11.5T680-760q0 17 11.5 28.5T720-720ZM240-440q17 0 28.5-11.5T280-480q0-17-11.5-28.5T240-520q-17 0-28.5 11.5T200-480q0 17 11.5 28.5T240-440Zm480 280q17 0 28.5-11.5T760-200q0-17-11.5-28.5T720-240q-17 0-28.5 11.5T680-200q0 17 11.5 28.5T720-160Z"/></svg> VaultStream</h1>
        
        <form id="shareForm">
            <div class="form-group">
                <label class="field-label" for="url">URL Êàñ ÂÜÖÂÆπ ID (BV/av/cv)</label>
                <input 
                    type="text" 
                    id="url" 
                    name="url" 
                    placeholder="ËæìÂÖ•ÈìæÊé•Êàñ B Á´ô ID..."
                    required
                >
            </div>
            
            <div class="form-group">
                <label class="field-label" for="tags">Ê†áÁ≠æ (ÊîØÊåÅ , Ôºå „ÄÅ ÂàÜÈöî)</label>
                <input 
                    type="text" 
                    id="tags" 
                    name="tags" 
                    placeholder="‰æãÂ¶Ç: ÊäÄÊúØ„ÄÅÊïôÁ®ã, bilibili"
                >
            </div>
            
            <div class="form-group">
                <label class="field-label" for="source">Êù•Ê∫êÊ†áËØÜ</label>
                <input 
                    type="text" 
                    id="source" 
                    name="source" 
                    placeholder="‰æãÂ¶Ç: web_test"
                >
            </div>
            
            <div class="form-group">
                <label class="checkbox-group">
                    <input type="checkbox" id="is_nsfw" name="is_nsfw">
                    <span>Ê†áËÆ∞‰∏∫ NSFW ÂÜÖÂÆπ</span>
                </label>
            </div>
            
            <button type="submit" id="submitBtn">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M120-160v-640l760 320-760 320Zm80-120 474-200-474-200v140l240 60-240 60v140Zm0 0v-400 400Z"/></svg>
                Êèê‰∫§ÂàÜ‰∫´
            </button>
        </form>
        
        <div id="result" class="result"></div>
        
        <div class="examples">
            <h3>üìã Âø´ÈÄüÂ°´ÂÖÖ</h3>
            <div class="example-chips">
                <div class="chip" data-url="BV1xx411c7XD">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="m140-220 60-120h100l-60 120h-100Zm140 0 60-120h100l-60 120h-100Zm140 0 60-120h100l-60 120h-100Zm140 0 60-120h100l-60 120h-100ZM120-120q-33 0-56.5-23.5T40-200v-560q0-33 23.5-56.5T120-840h720q33 0 56.5 23.5T920-760v560q0-33-23.5-56.5T840-120H120Zm0-80h720v-480H120v480Zm0 0v-480 480Z"/></svg> BV1xx411c7XD
                </div>
                <div class="chip" data-url="cv12345678">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M320-240h320v-80H320v80Zm0-160h320v-80H320v80ZM240-80q-33 0-56.5-23.5T160-160v-640q0-33 23.5-56.5T240-880h320l240 240v480q0 33-23.5 56.5T720-80H240Zm280-560v-160H240v640h480v-480H520ZM240-800v160-160 640-640Z"/></svg> cv12345678
                </div>
                <div class="chip" data-url="https://www.bilibili.com/opus/1150580721704763430">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M240-400h320v-80H240v80Zm0-120h480v-80H240v80Zm0-120h480v-80H240v80ZM80-80v-720q0-33 23.5-56.5T160-880h640q33 0 56.5 23.5T880-800v480q0 33-23.5 56.5T800-240H240L80-80Zm126-240h594v-480H160v525l46-45Zm-46 0v-480 480Z"/></svg> Âä®ÊÄÅÈìæÊé•
                </div>
            </div>
        </div>
    </div>
    
    <script>
        const API_BASE = 'http://localhost:8000/api/v1';
        
        const ICONS = {
            send: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M120-160v-640l760 320-760 320Zm80-120 474-200-474-200v140l240 60-240 60v140Zm0 0v-400 400Z"/></svg>',
            hourglass: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M240-80v-120l160-160v-240L240-760v-120h480v120L560-720v240l160 160v120H240Zm80-80h320v-53l-160-160-160 160v53Zm0-487 160-160 160 160v53H320v-53Zm160 167Zm0 160Z"/></svg>'
        };

        // Á§∫‰æãÈìæÊé•ÁÇπÂáª‰∫ã‰ª∂
        document.querySelectorAll('.chip').forEach(item => {
            item.addEventListener('click', () => {
                document.getElementById('url').value = item.dataset.url;
            });
        });

        // URL ËßÑËåÉÂåñÈÄªËæë
        function normalizeUrl(url) {
            url = url.trim();
            if (/^BV[a-zA-Z0-9]+$/i.test(url)) {
                return `https://www.bilibili.com/video/${url}`;
            }
            if (/^av\d+$/i.test(url)) {
                return `https://www.bilibili.com/video/${url}`;
            }
            if (/^cv\d+$/i.test(url)) {
                return `https://www.bilibili.com/read/${url}`;
            }
            return url;
        }
        
        // Ë°®ÂçïÊèê‰∫§
        document.getElementById('shareForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            const resultDiv = document.getElementById('result');
            
            // Ëé∑ÂèñÂπ∂ËßÑËåÉÂåñÊï∞ÊçÆ
            const rawUrl = document.getElementById('url').value;
            const url = normalizeUrl(rawUrl);
            
            const tagsInput = document.getElementById('tags').value;
            // ÂÖºÂÆπ‰∏≠Ëã±ÊñáÈÄóÂè∑ÂíåÈ°øÂè∑
            const tags = tagsInput ? tagsInput.split(/[,Ôºå„ÄÅ]/).map(t => t.trim()).filter(t => t) : [];
            
            const source = document.getElementById('source').value || null;
            const is_nsfw = document.getElementById('is_nsfw').checked;
            
            submitBtn.disabled = true;
            submitBtn.innerHTML = `${ICONS.hourglass} Êèê‰∫§‰∏≠...`;
            resultDiv.style.display = 'none';
            
            try {
                const response = await fetch(`${API_BASE}/shares`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ url, tags, source, is_nsfw })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = `
                        <strong>‚úÖ Êèê‰∫§ÊàêÂäü</strong><br>
                        <small>ID: ${data.id} | Âπ≥Âè∞: ${data.platform}</small><br>
                        ÂÜÖÂÆπÊ≠£Âú®ÂêéÂè∞Ëß£Êûê‰∏≠...
                    `;
                    document.getElementById('shareForm').reset();
                } else {
                    throw new Error(data.detail || 'Êèê‰∫§Â§±Ë¥•');
                }
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `<strong>‚ùå ÈîôËØØ</strong><br>${error.message}`;
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML = `${ICONS.send} Êèê‰∫§ÂàÜ‰∫´`;
                resultDiv.style.display = 'block';
            }
        });
    </script>
</body>
</html>
